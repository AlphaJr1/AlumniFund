<!DOCTYPE html>
<html>

<head>
  <!--
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
  -->
  <base href="$FLUTTER_BASE_HREF">

  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="Community fund management platform">

  <!-- iOS meta tags & icons -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="UNAME">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png" />

  <title>UNAME</title>
  <link rel="manifest" href="manifest.json">

  <!-- Google Fonts - Inter for better web compatibility -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* Font configuration to prevent Noto fonts warning */
    body,
    html {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
    }

    /* Ensure Flutter canvas uses system fonts for emoji */
    flt-glass-pane * {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol' !important;
    }

    /* Animated gradient keyframes */
    @keyframes gradientShift {
      0% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }
  </style>

  <script>
    // The value below is injected by flutter build, do not touch.
    var serviceWorkerVersion = null;
  </script>
  <!-- Shared storage for cross-profile testing -->
  <script src="shared_storage.js"></script>
  <!-- This script adds the flutter initialization JS code -->
  <script src="flutter.js" defer></script>
</head>

<body>
  <!-- Loading Screen - Clean & Minimal Design -->
  <div id="loading-screen" style="
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #FAFAFA;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    font-family: 'Inter', sans-serif;
  ">
    <!-- App Name -->
    <h1 style="
      color: #1F2937;
      font-size: 42px;
      font-weight: 700;
      margin: 0 0 12px 0;
      letter-spacing: -0.5px;
    ">UNAME</h1>

    <!-- Slogan -->
    <p style="
      color: #6B7280;
      font-size: 16px;
      margin: 0 0 48px 0;
      font-weight: 400;
    ">Together, anyway</p>

    <!-- Animated Gradient Progress Bar -->
    <div style="
      width: 320px;
      height: 6px;
      background: #E5E7EB;
      border-radius: 3px;
      overflow: hidden;
      margin-bottom: 20px;
    ">
      <div id="progress-bar" style="
        width: 30%;
        height: 100%;
        background: linear-gradient(
          90deg,
          #EC4899 0%,
          #8B5CF6 16.67%,
          #3B82F6 33.33%,
          #06B6D4 50%,
          #10B981 66.67%,
          #F59E0B 83.33%,
          #EF4444 100%
        );
        background-size: 200% 100%;
        border-radius: 3px;
        animation: gradientShift 3s ease infinite;
        box-shadow: 0 0 12px rgba(236, 72, 153, 0.3);
      "></div>
    </div>

    <!-- Loading Message - Very Subtle -->
    <div id="loading-message" style="
      color: rgba(107, 114, 128, 0.5);
      font-size: 13px;
      font-weight: 400;
      font-style: italic;
    ">Initializing app</div>
  </div>

  <script>
    // Animate progress bar and loading messages
    const progressBar = document.getElementById('progress-bar');
    const loadingMessage = document.getElementById('loading-message');

    const messages = [
      'Initializing app',
      'Loading components',
      'Preparing interface',
      'Almost ready'
    ];

    let messageIndex = 0;
    let progress = 30;

    // Update message periodically
    const messageInterval = setInterval(() => {
      messageIndex = (messageIndex + 1) % messages.length;
      loadingMessage.textContent = messages[messageIndex];
    }, 1500);

    // Slowly increase progress width
    const progressInterval = setInterval(() => {
      progress += Math.random() * 5;
      if (progress > 85) progress = 85; // Cap at 85% until real load
      progressBar.style.width = progress + '%';
    }, 300);

    window.addEventListener('load', function (ev) {
      // Download main.dart.js
      _flutter.loader.loadEntrypoint({
        serviceWorker: {
          serviceWorkerVersion: serviceWorkerVersion,
        },
        onEntrypointLoaded: function (engineInitializer) {
          loadingMessage.textContent = 'Starting app';
          progress = 90;
          progressBar.style.width = '90%';

          engineInitializer.initializeEngine().then(function (appRunner) {
            appRunner.runApp().then(function () {
              loadingMessage.textContent = 'Ready';
              progress = 100;
              progressBar.style.width = '100%';
              clearInterval(messageInterval);
              clearInterval(progressInterval);

              // Hide loading screen with fade after app fully initialized
              setTimeout(() => {
                const loadingScreen = document.getElementById('loading-screen');
                loadingScreen.style.transition = 'opacity 0.6s ease';
                loadingScreen.style.opacity = '0';
                setTimeout(() => {
                  loadingScreen.style.display = 'none';
                }, 600);
              }, 500);
            });
          });
        }
      });
    });
  </script>
</body>

</html>